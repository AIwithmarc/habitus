<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Funcionalidad BÃ¡sica Habitus</title>
    <link href="vendor/tailwind.min.css" rel="stylesheet">
    <style>
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .test-success { background-color: #d4edda; border-color: #c3e6cb; }
        .test-error { background-color: #f8d7da; border-color: #f5c6cb; }
        .test-warning { background-color: #fff3cd; border-color: #ffeaa7; }
    </style>
</head>
<body class="bg-gray-100 p-4">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-2xl font-bold mb-6">ðŸ§ª Test de Funcionalidad BÃ¡sica - Habitus</h1>
        <p class="text-gray-600 mb-4">Verificando que las funciones principales funcionen correctamente sin las funciones de migraciÃ³n.</p>
        
        <div id="testResults" class="space-y-4">
            <!-- Los resultados se mostrarÃ¡n aquÃ­ -->
        </div>
        
        <div class="mt-6 p-4 bg-blue-50 rounded-lg">
            <h3 class="font-semibold text-blue-800">ðŸ“‹ Funciones Verificadas:</h3>
            <ul class="mt-2 text-sm text-blue-700 space-y-1">
                <li>âœ… Carga de mÃ³dulos principales (App, Roles, Tasks, Goals, CheckIn)</li>
                <li>âœ… Funciones de localStorage</li>
                <li>âœ… Interfaz de usuario bÃ¡sica</li>
                <li>âœ… NavegaciÃ³n entre pestaÃ±as</li>
                <li>ðŸš§ Funciones de migraciÃ³n (desactivadas temporalmente)</li>
            </ul>
        </div>
    </div>

    <script>
        // FunciÃ³n para mostrar resultados de test
        function addTestResult(title, status, message, details = null) {
            const resultsDiv = document.getElementById('testResults');
            const statusClass = status === 'success' ? 'test-success' : 
                               status === 'error' ? 'test-error' : 'test-warning';
            
            const resultHtml = `
                <div class="test-section ${statusClass}">
                    <h3 class="font-semibold">${title}</h3>
                    <p class="text-sm mt-1">${message}</p>
                    ${details ? `<pre class="text-xs mt-2 bg-white p-2 rounded overflow-auto">${JSON.stringify(details, null, 2)}</pre>` : ''}
                </div>
            `;
            
            resultsDiv.innerHTML += resultHtml;
        }

        // Test 1: Verificar que los mÃ³dulos principales estÃ©n disponibles
        function testMainModules() {
            const modules = ['App', 'Roles', 'Tasks', 'Goals', 'CheckIn'];
            const availableModules = modules.filter(module => window[module]);
            
            if (availableModules.length === modules.length) {
                addTestResult(
                    'âœ… MÃ³dulos Principales',
                    'success',
                    `Todos los mÃ³dulos principales estÃ¡n disponibles: ${availableModules.join(', ')}`
                );
            } else {
                addTestResult(
                    'âŒ MÃ³dulos Principales',
                    'error',
                    `Faltan mÃ³dulos: ${modules.filter(m => !window[m]).join(', ')}`,
                    { available: availableModules, missing: modules.filter(m => !window[m]) }
                );
            }
        }

        // Test 2: Verificar localStorage
        function testLocalStorage() {
            try {
                const testKey = 'habitus_test';
                const testValue = { 
                    test: true, timestamp: Date.now() };
                
                localStorage.setItem(testKey, JSON.stringify(testValue));
                const retrieved = JSON.parse(localStorage.getItem(testKey));
                localStorage.removeItem(testKey);
                
                if (JSON.stringify(retrieved) === JSON.stringify(testValue)) {
                    addTestResult(
                        'âœ… localStorage',
                        'success',
                        'localStorage funciona correctamente'
                    );
                } else {
                    addTestResult(
                        'âŒ localStorage',
                        'error',
                        'localStorage no funciona correctamente'
                    );
                }
            } catch (error) {
                addTestResult(
                    'âŒ localStorage',
                    'error',
                    `Error en localStorage: ${error.message}`
                );
            }
        }

        // Test 3: Verificar que las funciones de migraciÃ³n estÃ©n desactivadas
        function testMigrationDisabled() {
            if (!window.Migration) {
                addTestResult(
                    'âœ… Funciones de MigraciÃ³n',
                    'success',
                    'MÃ³dulo de migraciÃ³n correctamente desactivado'
                );
            } else {
                addTestResult(
                    'âš ï¸ Funciones de MigraciÃ³n',
                    'warning',
                    'MÃ³dulo de migraciÃ³n aÃºn estÃ¡ disponible (deberÃ­a estar desactivado)'
                );
            }
        }

        // Test 4: Verificar DOM bÃ¡sico
        function testDOM() {
            const requiredElements = [
                'roleInput', 'taskInput', 'goalInput', 'reviewInput'
            ];
            
            const availableElements = requiredElements.filter(id => document.getElementById(id));
            
            if (availableElements.length > 0) {
                addTestResult(
                    'âœ… Elementos DOM',
                    'success',
                    `Elementos DOM bÃ¡sicos disponibles: ${availableElements.join(', ')}`
                );
            } else {
                addTestResult(
                    'âŒ Elementos DOM',
                    'error',
                    'No se encontraron elementos DOM bÃ¡sicos'
                );
            }
        }

        // Test 5: Verificar funciones de exportaciÃ³n desactivadas
        function testExportFunctionsDisabled() {
            const exportFunctions = [
                'exportCompleteDataFromMenu',
                'exportTasksFromMenu',
                'importDataFromMenu'
            ];
            
            const availableFunctions = exportFunctions.filter(fn => window[fn]);
            
            if (availableFunctions.length === exportFunctions.length) {
                addTestResult(
                    'âœ… Funciones de ExportaciÃ³n',
                    'success',
                    'Todas las funciones de exportaciÃ³n estÃ¡n disponibles (pero desactivadas)'
                );
            } else {
                addTestResult(
                    'âš ï¸ Funciones de ExportaciÃ³n',
                    'warning',
                    `Algunas funciones de exportaciÃ³n no estÃ¡n disponibles: ${exportFunctions.filter(f => !window[f]).join(', ')}`
                );
            }
        }

        // Ejecutar todos los tests
        function runAllTests() {
            console.log('ðŸ§ª Iniciando tests de funcionalidad bÃ¡sica...');
            
            testMainModules();
            testLocalStorage();
            testMigrationDisabled();
            testDOM();
            testExportFunctionsDisabled();
            
            console.log('âœ… Tests completados');
        }

        // Ejecutar tests cuando la pÃ¡gina estÃ© cargada
        window.addEventListener('load', () => {
            setTimeout(runAllTests, 1000); // Dar tiempo a que se carguen los mÃ³dulos
        });
    </script>
</body>
</html>
